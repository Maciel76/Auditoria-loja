import{_ as h,u as S,c as v,a as l,b as s,t as u,n as L,o as c,d as b,e as D,f as g,r as d,g as p,F as k,h as T,i as M,j as x,Q as O,k as N,l as H}from"./index-BdVT9xQe.js";const E={name:"PerfilHeader",props:{usuario:{type:Object,required:!0},corredoresUnicos:{type:Array,default:()=>[]},percentualConcluido:{type:Number,default:0},posicaoRanking:{type:Number,default:1},mediaDesempenho:{type:Number,default:0}},setup(e){const a=S(),t=v(()=>(e.usuario.contador||0)+(e.usuario.xpConquistas||0)),o=v(()=>a.calcularNivel(t.value)),n=v(()=>a.obterTitulo(o.value)),i=v(()=>t.value%100),r=v(()=>e.usuario.totalAuditorias||0),f=v(()=>{const m=o.value;return m>=50?"üëë":m>=40?"üíé":m>=30?"üèÜ":m>=20?"ü•á":m>=10?"‚≠ê":m>=5?"üéØ":"üÜï"});return{xpAtual:t,nivelAtual:o,tituloAtual:n,progressoXp:i,totalAuditorias:r,tituloIcon:f}}},X={class:"perfil-header"},G={class:"perfil-cover"},V={class:"nivel-badge"},z={class:"nivel-number"},Q={class:"perfil-info"},Z={class:"avatar-container"},J={class:"avatar-wrapper"},K=["src","alt"],W={key:1,class:"avatar-placeholder"},Y={class:"avatar-badge"},ee={class:"icon"},ae={class:"xp-container"},te={class:"xp-bar"},oe={class:"xp-text"},se={class:"perfil-details"},re={class:"usuario-nome"},ie={class:"usuario-matricula"},ne={class:"usuario-titulo"},ce={class:"perfil-stats"},ue={class:"stat-item nivel"},de={class:"stat-number"},le={class:"stat-item auditorias"},me={class:"stat-number"},he={class:"stat-item ranking"},pe={class:"stat-number"},fe={class:"stat-item desempenho"},_e={class:"stat-number"};function ve(e,a,t,o,n,i){return c(),l("div",X,[s("div",G,[a[1]||(a[1]=s("div",{class:"cover-pattern"},null,-1)),s("div",V,[s("span",z,u(o.nivelAtual),1),a[0]||(a[0]=s("span",{class:"nivel-label"},"N√çVEL",-1))])]),s("div",Q,[s("div",Z,[s("div",J,[t.usuario.foto?(c(),l("img",{key:0,src:t.usuario.foto,alt:t.usuario.nome,class:"avatar-img"},null,8,K)):(c(),l("div",W,u(t.usuario.iniciais),1)),s("div",Y,[s("span",ee,u(o.tituloIcon),1)])]),s("div",ae,[s("div",te,[s("div",{class:"xp-fill",style:L({width:`${o.progressoXp}%`})},null,4)]),s("span",oe,u(o.xpAtual%100)+"/100 XP para n√≠vel "+u(o.nivelAtual+1),1)])]),s("div",se,[s("h1",re,u(t.usuario.nome),1),s("p",ie,"Matr√≠cula: "+u(t.usuario.id),1),s("p",ne,u(o.tituloAtual),1)]),s("div",ce,[s("div",ue,[s("span",de,u(o.nivelAtual),1),a[2]||(a[2]=s("span",{class:"stat-label"},"N√≠vel Atual",-1))]),s("div",le,[s("span",me,u(o.totalAuditorias),1),a[3]||(a[3]=s("span",{class:"stat-label"},"Auditorias",-1))]),s("div",he,[s("span",pe,"#"+u(t.posicaoRanking),1),a[4]||(a[4]=s("span",{class:"stat-label"},"Posi√ß√£o",-1))]),s("div",fe,[s("span",_e,u(t.mediaDesempenho)+"%",1),a[5]||(a[5]=s("span",{class:"stat-label"},"Desempenho",-1))])])])])}const ge=h(E,[["render",ve],["__scopeId","data-v-1218f4f3"]]),qe={name:"ConquistaBase",props:{conquistaData:{type:Object,required:!0,default:()=>({id:"",nome:"",descricao:"",icone:"üèÜ",xp:0,desbloqueada:!1,nova:!1,repeticao:null,progresso:void 0})}}},be={class:"conquista-icon"},Ce={class:"icon-emoji"},Pe={key:0,class:"check-mark"},De={class:"conquista-content"},xe={class:"conquista-nome"},$e={class:"conquista-descricao"},Ae={class:"conquista-details"},ye={class:"xp-badge"},Me={class:"xp-value"},ke={key:0,class:"repeticao-badge"},Le={class:"repeticao-text"},Te={key:0,class:"progresso-container"},Se={class:"progresso-bar"},Ie={class:"progresso-text"},Ue={key:0,class:"nova-badge"};function je(e,a,t,o,n,i){return c(),l("div",{class:D(["conquista-card",{desbloqueada:t.conquistaData.desbloqueada,nova:t.conquistaData.nova,repeticao:t.conquistaData.repeticao}])},[s("div",be,[s("span",Ce,u(t.conquistaData.icone),1),t.conquistaData.desbloqueada?(c(),l("div",Pe,"‚úì")):b("",!0)]),s("div",De,[s("h3",xe,u(t.conquistaData.nome),1),s("p",$e,u(t.conquistaData.descricao),1),s("div",Ae,[s("div",ye,[a[0]||(a[0]=s("span",{class:"xp-icon"},"‚≠ê",-1)),s("span",Me,u(t.conquistaData.xp)+" XP",1)]),t.conquistaData.repeticao?(c(),l("div",ke,[a[1]||(a[1]=s("span",{class:"repeticao-icon"},"üîÑ",-1)),s("span",Le,u(t.conquistaData.repeticao),1)])):b("",!0)]),t.conquistaData.progresso!==void 0?(c(),l("div",Te,[s("div",Se,[s("div",{class:"progresso-fill",style:L({width:`${Math.min(100,t.conquistaData.progresso)}%`})},null,4)]),s("span",Ie,u(Math.min(100,Math.round(t.conquistaData.progresso)))+"% ",1)])):b("",!0)]),t.conquistaData.nova?(c(),l("div",Ue,[...a[2]||(a[2]=[s("span",null,"NOVO!",-1)])])):b("",!0)],2)}const q=h(qe,[["render",je],["__scopeId","data-v-bcba592d"]]),Re={name:"PrimeiroDia",components:{ConquistaBase:q},props:{usuario:{type:Object,required:!0}},computed:{conquistaData(){const e=(this.usuario.contador||0)>0;return{id:"primeira_auditoria",nome:"Primeiro Dia",descricao:"Fez sua primeira auditoria",icone:"üéâ",xp:10,desbloqueada:e,nova:e&&!this.usuario.conquistasAntigas?.includes("primeira_auditoria"),progresso:e?100:0}}}};function we(e,a,t,o,n,i){const r=d("ConquistaBase");return c(),g(r,{"conquista-data":i.conquistaData},null,8,["conquista-data"])}const Fe=h(Re,[["render",we]]),Be={name:"MetaBatida",components:{ConquistaBase:q},props:{usuario:{type:Object,required:!0}},computed:{conquistaData(){const e=this.usuario.contador||0,a=e>=500,t=Math.min(100,e/500*100);return{id:"meta_500",nome:"Meta Batida",descricao:"Leu mais de 500 itens",icone:"üéØ",xp:50,desbloqueada:a,nova:a&&!this.usuario.conquistasAntigas?.includes("meta_500"),progresso:t}}}};function Oe(e,a,t,o,n,i){const r=d("ConquistaBase");return c(),g(r,{"conquista-data":i.conquistaData},null,8,["conquista-data"])}const Ne=h(Be,[["render",Oe]]),He={name:"Explorador",components:{ConquistaBase:q},props:{usuario:{type:Object,required:!0},corredoresUnicos:{type:Array,default:()=>[]}},computed:{conquistaData(){const e=this.corredoresUnicos.length,a=e>=5,t=Math.min(100,e/5*100);return{id:"explorador",nome:"Explorador",descricao:`Cobriu ${e}/5+ corredores`,icone:"üó∫Ô∏è",xp:25,desbloqueada:a,nova:a&&!this.usuario.conquistasAntigas?.includes("explorador"),progresso:t}}}};function Ee(e,a,t,o,n,i){const r=d("ConquistaBase");return c(),g(r,{"conquista-data":i.conquistaData},null,8,["conquista-data"])}const Xe=h(He,[["render",Ee]]),Ge={name:"Maratona",components:{ConquistaBase:q},props:{usuario:{type:Object,required:!0}},computed:{conquistaData(){const e=this.usuario.contador||0,a=e>=1e3,t=Math.min(100,e/1e3*100);return{id:"maratona",nome:"Maratona",descricao:"Leu mais de 1000 itens",icone:"üèÖ",xp:100,desbloqueada:a,nova:a&&!this.usuario.conquistasAntigas?.includes("maratona"),progresso:t}}}};function Ve(e,a,t,o,n,i){const r=d("ConquistaBase");return c(),g(r,{"conquista-data":i.conquistaData},null,8,["conquista-data"])}const ze=h(Ge,[["render",Ve]]),Qe={name:"Relampago",components:{ConquistaBase:q},props:{usuario:{type:Object,required:!0},atividadesRecentes:{type:Array,default:()=>[]}},computed:{conquistaData(){const e=this.verificarConquista(),a=Math.min(100,this.atividadesRecentes.length/50*100);return{id:"relampago",nome:"Rel√¢mpago",descricao:"Verificou 50 itens rapidamente",icone:"‚ö°",xp:35,desbloqueada:e,nova:e&&!this.usuario.conquistasAntigas?.includes("relampago"),repeticao:"di√°ria",progresso:a}}},methods:{verificarConquista(){if(!this.atividadesRecentes||this.atividadesRecentes.length<50)return!1;const e=this.atividadesRecentes[0]?.timestamp,a=this.atividadesRecentes[49]?.timestamp;return!e||!a?!1:(e-a)/(1e3*60*60)<1}}};function Ze(e,a,t,o,n,i){const r=d("ConquistaBase");return c(),g(r,{"conquista-data":i.conquistaData},null,8,["conquista-data"])}const Je=h(Qe,[["render",Ze]]),Ke={name:"ZeroFaltas",components:{ConquistaBase:q},props:{usuario:{type:Object,required:!0},itensFaltantes:{type:Array,default:()=>[]}},computed:{conquistaData(){const e=this.itensFaltantes.length===0&&(this.usuario.contador||0)>0,a=this.itensFaltantes.length===0?100:0;return{id:"zero_faltas",nome:"Zero Faltas",descricao:"Nenhum item com estoque baixo",icone:"üõ°Ô∏è",xp:30,desbloqueada:e,nova:e&&!this.usuario.conquistasAntigas?.includes("zero_faltas"),repeticao:"por auditoria",progresso:a}}}};function We(e,a,t,o,n,i){const r=d("ConquistaBase");return c(),g(r,{"conquista-data":i.conquistaData},null,8,["conquista-data"])}const Ye=h(Ke,[["render",We]]),ea={name:"Detetive",components:{ConquistaBase:q},props:{usuario:{type:Object,required:!0},itensFaltantes:{type:Array,default:()=>[]}},computed:{conquistaData(){const e=this.itensFaltantes.length,a=e>=10,t=Math.min(100,e/10*100);return{id:"detetive",nome:"Detetive",descricao:`Identificou ${e}/10+ itens faltantes`,icone:"üîç",xp:20,desbloqueada:a,nova:a&&!this.usuario.conquistasAntigas?.includes("detetive"),progresso:t}}}};function aa(e,a,t,o,n,i){const r=d("ConquistaBase");return c(),g(r,{"conquista-data":i.conquistaData},null,8,["conquista-data"])}const ta=h(ea,[["render",aa]]),oa={name:"Consistencia",components:{ConquistaBase:q},props:{usuario:{type:Object,required:!0}},computed:{conquistaData(){const a=(this.usuario.contador||0)/500*100,t=a>=75,o=Math.min(100,a/75*100);return{id:"consistencia",nome:"Consist√™ncia",descricao:`${Math.round(a)}% de conclus√£o (meta: 75%+)`,icone:"üìà",xp:25,desbloqueada:t,nova:t&&!this.usuario.conquistasAntigas?.includes("consistencia"),progresso:o}}}};function sa(e,a,t,o,n,i){const r=d("ConquistaBase");return c(),g(r,{"conquista-data":i.conquistaData},null,8,["conquista-data"])}const ra=h(oa,[["render",sa]]),ia={name:"GuardiaoPresencaAvancado",components:{ConquistaBase:q},props:{usuario:{type:Object,required:!0}},computed:{conquistaData(){const e=this.obterCorredoresCompletos(),a=e.length>0;return{id:"guardiao_presenca_avancado",nome:this.gerarNome(e),descricao:this.gerarDescricao(e),icone:this.gerarIcone(e),xp:this.calcularXP(e),desbloqueada:a,progresso:this.calcularProgresso(e),tipo:"√∫nica",dadosExtras:{corredoresCompletos:e,nivelGuardiao:this.calcularNivelGuardiao(e)}}},corredoresCompletos(){return this.obterCorredoresCompletos()}},methods:{obterCorredoresCompletos(){return(this.usuario.auditorias?.presenca||[]).filter(a=>this.verificarCoberturaCompleta(a)&&this.verificarPrecisaoPerfeita(a)).map(a=>({id:a.corredorId,nome:a.corredorNome,data:a.data,totalItens:a.totalItens,itensAuditados:a.itensAuditados,precisao:a.taxaPrecisao}))},verificarCoberturaCompleta(e){return e.itensAuditados>=e.totalItens},verificarPrecisaoPerfeita(e){return e.taxaPrecisao===100},gerarNome(e){const a={1:"Guardi√£o da Presen√ßa",3:"Guardi√£o Elite",5:"Mestre da Presen√ßa",10:"Lenda da Auditoria"},t=this.calcularNivelGuardiao(e);return a[t]||"Guardi√£o Supremo"},gerarIcone(e){const a=this.calcularNivelGuardiao(e),t=["üõ°Ô∏è","‚öîÔ∏è","üèÜ","üëë"];return t[Math.min(a-1,t.length-1)]||"üõ°Ô∏è"},calcularNivelGuardiao(e){const a=e.length;return a>=10?4:a>=5?3:a>=3?2:1},calcularProgresso(e){const a=this.calcularNivelGuardiao(e);return Math.min(100,a/4*100)},calcularXP(e){const o=this.calcularNivelGuardiao(e)*50;return 200+e.length*75+o},gerarDescricao(e){const a=e.length;return a===0?"Complete um corredor com cobertura e precis√£o totais":{1:"Primeiro corredor completo com perfei√ß√£o!",3:"Dom√≠nio em m√∫ltiplos corredores",5:"Mestre da auditoria de presen√ßa",10:"Lend√°ria precis√£o em todos os corredores"}[a]||`${a} corredores com auditoria perfeita`},formatarData(e){return new Date(e).toLocaleDateString("pt-BR")}}},na={class:"guardiao-presenca-avancado"},ca={key:0,class:"corredores-completos"},ua={class:"corredores-lista"},da={class:"corredor-nome"},la={class:"corredor-data"},ma={class:"corredor-itens"};function ha(e,a,t,o,n,i){const r=d("ConquistaBase");return c(),l("div",na,[p(r,{"conquista-data":i.conquistaData},null,8,["conquista-data"]),i.conquistaData.desbloqueada&&i.corredoresCompletos.length>0?(c(),l("div",ca,[a[1]||(a[1]=s("h4",null,"Corredores Perfeitos:",-1)),s("div",ua,[(c(!0),l(k,null,T(i.corredoresCompletos,f=>(c(),l("div",{key:f.id,class:"corredor-item"},[a[0]||(a[0]=s("span",{class:"corredor-icone"},"‚úÖ",-1)),s("span",da,u(f.nome),1),s("span",la,u(i.formatarData(f.data)),1),s("span",ma,u(f.itensAuditados)+" itens",1)]))),128))])])):b("",!0)])}const pa=h(ia,[["render",ha],["__scopeId","data-v-14de4fab"]]),fa={name:"LendaViva",components:{ConquistaBase:q},props:{usuario:{type:Object,required:!0}},computed:{conquistaData(){const e=this.obterNiveis(),a=this.usuario.diasAuditados||0,t=this.encontrarNivelAtual(a,e),o=this.encontrarProximoNivel(a,e);return{id:`lenda_viva_${t.meta}`,nome:t.nome,descricao:this.gerarDescricao(t,a),icone:t.icone,xp:t.xp,desbloqueada:a>=t.meta,progresso:this.calcularProgresso(a,t,o),repeticao:"recorrente",dadosExtras:{nivelAtual:t.meta,nivelAtualNome:t.nome,proximoNivel:o.meta,proximoNivelNome:o.nome,diasAuditados:a,progressoParaProximo:this.calcularProgressoParaProximo(a,t,o)}}}},methods:{obterNiveis(){return[{meta:5,nome:"Iniciante Dedicado",xp:25,icone:"üå±"},{meta:10,nome:"Auditor Ativo",xp:50,icone:"üöÄ"},{meta:25,nome:"Veterano",xp:100,icone:"üõ°Ô∏è"},{meta:50,nome:"Lenda Viva",xp:250,icone:"üèõÔ∏è"},{meta:75,nome:"Mestre Lend√°rio",xp:400,icone:"üëë"},{meta:100,nome:"√çcone dos Auditores",xp:600,icone:"üåü"},{meta:200,nome:"Lenda Imortal",xp:1e3,icone:"üí´"}]},encontrarNivelAtual(e,a){const t=a.filter(o=>e>=o.meta);return t.length>0?t[t.length-1]:{meta:0,nome:"Novato",xp:0,icone:"üéØ"}},encontrarProximoNivel(e,a){return a.find(o=>o.meta>e)||this.encontrarNivelAtual(e,a)},calcularProgresso(e,a,t){if(e>=t.meta||a.meta===t.meta)return 100;const o=t.meta-a.meta,n=e-a.meta;return Math.min(100,n/o*100)},calcularProgressoParaProximo(e,a,t){if(a.meta===t.meta)return{atual:0,total:0,percentual:100};const o=e-a.meta,n=t.meta-a.meta,i=Math.min(100,o/n*100);return{atual:o,total:n,percentual:i}},gerarDescricao(e,a){const t="Realizou auditorias em dias diferentes";return e.meta===200?`${t} - Lenda Imortal alcan√ßada!`:`${t} - ${a}/${e.meta} dias`}}};function _a(e,a,t,o,n,i){const r=d("ConquistaBase");return c(),g(r,{"conquista-data":i.conquistaData},null,8,["conquista-data"])}const va=h(fa,[["render",_a],["__scopeId","data-v-5866f3df"]]),ga={name:"LiderPodio",components:{ConquistaBase:q},props:{usuario:{type:Object,required:!0},rankingAuditoria:{type:Array,default:()=>[]},auditoriaId:{type:String,required:!0}},computed:{conquistaData(){const e=this.obterPosicaoUsuario(),a=e!==null&&e<=3;return{id:`lider_podio_${this.auditoriaId}`,nome:this.gerarNome(e),descricao:this.gerarDescricao(e),icone:this.gerarIcone(e),xp:this.calcularXP(e),desbloqueada:a,progresso:this.calcularProgresso(e),repeticao:"recorrente",dadosExtras:{posicao:e,totalParticipantes:this.rankingAuditoria.length,auditoriaId:this.auditoriaId,itensLidos:this.obterItensLidosUsuario(),diferencaProximo:this.calcularDiferencaProximo(e)}}}},methods:{obterPosicaoUsuario(){if(!this.rankingAuditoria.length)return null;const e=this.rankingAuditoria.find(a=>a.usuarioId===this.usuario.id);return e?e.posicao:null},obterItensLidosUsuario(){const e=this.rankingAuditoria.find(a=>a.usuarioId===this.usuario.id);return e?e.itensLidos:0},gerarNome(e){return{1:"ü•á L√≠der do P√≥dio",2:"ü•à Vice-L√≠der",3:"ü•â Top 3"}[e]||"L√≠der do P√≥dio"},gerarDescricao(e){return e===null?"Fique entre os 3 primeiros no ranking da auditoria":{1:"1¬∫ lugar no ranking! Maior n√∫mero de itens lidos!",2:"2¬∫ lugar no ranking! Excelente desempenho!",3:"3¬∫ lugar no ranking! Entre os melhores!"}[e]||`Posi√ß√£o ${e} no ranking da auditoria`},gerarIcone(e){return{1:"ü•á",2:"ü•à",3:"ü•â"}[e]||"üèÜ"},calcularXP(e){return{1:100,2:50,3:25}[e]||0},calcularProgresso(e){return e===null?0:e===1?100:e===2?66:e===3?33:0},calcularDiferencaProximo(e){if(!e||e>=3)return null;const a=this.rankingAuditoria.find(o=>o.usuarioId===this.usuario.id),t=this.rankingAuditoria.find(o=>o.posicao===e+1);return a&&t?a.itensLidos-t.itensLidos:null}}};function qa(e,a,t,o,n,i){const r=d("ConquistaBase");return c(),g(r,{"conquista-data":i.conquistaData},null,8,["conquista-data"])}const ba=h(ga,[["render",qa],["__scopeId","data-v-fe055710"]]),Ca={name:"MestreCorredores",components:{ConquistaBase:q},props:{usuario:{type:Object,required:!0},corredoresLoja:{type:Array,default:()=>[]}},computed:{conquistaData(){const e=this.obterCorredoresCobertos(),a=this.verificarCoberturaTotal(e);return{id:"mestre_corredores",nome:"Mestre dos Corredores",descricao:this.gerarDescricao(e),icone:"üèÜ",xp:this.calcularXP(e),desbloqueada:a,progresso:this.calcularProgresso(e),tipo:"√∫nica",dadosExtras:{corredoresCobertos:e,corredoresFaltantes:this.obterCorredoresFaltantes(e),totalCorredores:this.corredoresLoja.length,coberturaPercentual:this.calcularPercentualCobertura(e),dataConquista:this.obterDataConquista(e)}}}},methods:{obterCorredoresCobertos(){return this.usuario.corredoresCobertos||[]},verificarCoberturaTotal(e){if(this.corredoresLoja.length===0)return!1;const a=new Set(e.map(o=>o.id||o)),t=new Set(this.corredoresLoja.map(o=>o.id||o));for(let o of t)if(!a.has(o))return!1;return!0},calcularProgresso(e){if(this.corredoresLoja.length===0)return 0;const a=e.length/this.corredoresLoja.length*100;return Math.min(100,a)},calcularXP(e){return 500+Math.min(200,this.corredoresLoja.length*10)},gerarDescricao(e){const a=e.length,t=this.corredoresLoja.length;return t===0?"Cubra todos os corredores da loja":this.verificarCoberturaTotal(e)?`Dom√≠nio total! Todos os ${t} corredores cobertos!`:`${a}/${t} corredores da loja cobertos`},obterCorredoresFaltantes(e){if(this.corredoresLoja.length===0)return[];const a=new Set(e.map(t=>t.id||t));return this.corredoresLoja.filter(t=>!a.has(t.id||t))},calcularPercentualCobertura(e){return this.corredoresLoja.length===0?0:Math.round(e.length/this.corredoresLoja.length*100)},obterDataConquista(e){if(!this.verificarCoberturaTotal(e))return null;if(Array.isArray(e)&&e[0]?.data){const a=e.map(t=>t.data).sort();return a[a.length-1]}return new Date().toISOString().split("T")[0]}}};function Pa(e,a,t,o,n,i){const r=d("ConquistaBase");return c(),g(r,{"conquista-data":i.conquistaData},null,8,["conquista-data"])}const Da=h(Ca,[["render",Pa],["__scopeId","data-v-fabdbd1e"]]),xa={name:"OInvencivel",components:{ConquistaBase:q},props:{usuario:{type:Object,required:!0}},computed:{conquistaData(){const e=this.calcularSequenciaAtual(),a=e>=4;return{id:"o_invencivel",nome:"O Invenc√≠vel",descricao:this.gerarDescricao(e),icone:"üí™",xp:this.calcularXP(e),desbloqueada:a,progresso:this.calcularProgresso(e),tipo:"√∫nica",dadosExtras:{sequenciaAtual:e,semanasNecessarias:4,dataInicioSequencia:this.obterDataInicioSequencia(),ultimaSemanaTop:this.obterUltimaSemanaTop(),semanasCompletas:this.obterSemanasCompletas()}}}},methods:{calcularSequenciaAtual(){const a=(this.usuario.historicoTopPerformer||[]).map(n=>({...n,data:new Date(n.data)})).sort((n,i)=>i.data-n.data);let t=0,o=new Date;for(let n of a)if(this.calcularDiferencaSemanas(n.data,o)<=1)t++,o=new Date(n.data),o.setDate(o.getDate()-7);else break;return t},calcularDiferencaSemanas(e,a){const t=Math.abs(a-e);return Math.ceil(t/(1e3*60*60*24*7))},calcularProgresso(e){return Math.min(100,e/4*100)},calcularXP(e){return 500+Math.max(0,(e-4)*50)},gerarDescricao(e){return e>=4?`Invenc√≠vel! ${e} semanas consecutivas como Top Performer!`:e===0?"Mantenha 4 semanas consecutivas como Top Performer":`${e}/4 semanas como Top Performer consecutivas`},obterDataInicioSequencia(){const e=this.usuario.historicoTopPerformer||[];if(e.length===0)return null;const a=this.calcularSequenciaAtual();if(a===0)return null;const t=e.map(n=>({...n,data:new Date(n.data)})).sort((n,i)=>i.data-n.data).slice(0,a);return t[t.length-1].data.toISOString().split("T")[0]},obterUltimaSemanaTop(){const e=this.usuario.historicoTopPerformer||[];if(e.length===0)return null;const a=e.map(t=>({...t,data:new Date(t.data)})).sort((t,o)=>o.data-t.data)[0];return{data:a.data.toISOString().split("T")[0],posicao:a.posicao,itensLidos:a.itensLidos}},obterSemanasCompletas(){return(this.usuario.historicoTopPerformer||[]).map(a=>({data:a.data,posicao:a.posicao,itensLidos:a.itensLidos,desempenho:a.desempenho||"excelente"})).sort((a,t)=>new Date(t.data)-new Date(a.data))}}};function $a(e,a,t,o,n,i){const r=d("ConquistaBase");return c(),g(r,{"conquista-data":i.conquistaData},null,8,["conquista-data"])}const Aa=h(xa,[["render",$a],["__scopeId","data-v-e60a62e2"]]),ya={name:"PioneiroDia",components:{ConquistaBase:q},props:{usuario:{type:Object,required:!0},auditoriaAtual:{type:Object,default:()=>({})}},computed:{conquistaData(){const e=this.verificarSeFoiPioneiro(),a=this.obterDataAtual();return{id:`pioneiro_dia_${a}`,nome:"Pioneiro do Dia",descricao:this.gerarDescricao(e),icone:"üåÖ",xp:this.calcularXP(e),desbloqueada:e,progresso:this.calcularProgresso(e),repeticao:"di√°ria",dadosExtras:{foiPioneiro:e,dataAuditoria:a,horarioPrimeiraLeitura:this.obterHorarioPrimeiraLeitura(),totalParticipantes:this.obterTotalParticipantes(),diasComoPioneiro:this.calcularDiasComoPioneiro()}}}},methods:{verificarSeFoiPioneiro(){const e=this.auditoriaAtual.primeiraLeitura;return!e||!e.usuarioId?!1:e.usuarioId===this.usuario.id},obterDataAtual(){return new Date().toISOString().split("T")[0]},calcularProgresso(e){return e?100:0},calcularXP(e){return e?25:0},gerarDescricao(e){return e?`Primeira leitura do dia √†s ${this.obterHorarioPrimeiraLeitura()}!`:"Seja o primeiro a fazer uma leitura na auditoria do dia"},obterHorarioPrimeiraLeitura(){const e=this.auditoriaAtual.primeiraLeitura;return!e||!e.horario?"--:--":e.horario},obterTotalParticipantes(){return this.auditoriaAtual.participantes?.length||0},calcularDiasComoPioneiro(){return(this.usuario.historicoPioneiro||[]).length}}};function Ma(e,a,t,o,n,i){const r=d("ConquistaBase");return c(),g(r,{"conquista-data":i.conquistaData},null,8,["conquista-data"])}const ka=h(ya,[["render",Ma],["__scopeId","data-v-5cba2c4f"]]),La={name:"TopPerformer",components:{ConquistaBase:q},props:{usuario:{type:Object,required:!0},metricasGerais:{type:Object,default:()=>({})}},computed:{conquistaData(){const e=this.calcularAcimaDaMedia();return{id:"top_performer",nome:"Top Performer",descricao:this.obterDescricao(),icone:"‚≠ê",xp:this.calcularXP(),desbloqueada:e,progresso:this.calcularProgresso(),dadosExtras:{acimaDaMedia:e,metricasUsuario:this.obterMetricasUsuario(),metricasComparativas:this.obterMetricasComparativas(),periodo:this.obterPeriodo()}}}},methods:{calcularAcimaDaMedia(){const e=this.obterMetricasUsuario(),a=this.obterMetricasGerais();return[this.verificarProdutividade(e,a),this.verificarPrecisao(e,a),this.verificarConsistencia(e,a)].filter(Boolean).length>=2},verificarProdutividade(e,a){const t=e.itensPorHora||0,o=a.mediaItensPorHora||30;return t>o},verificarPrecisao(e,a){const t=e.taxaAcerto||0,o=a.mediaTaxaAcerto||85;return t>o},verificarConsistencia(e,a){const t=e.diasAtivos||0,o=a.mediaDiasAtivos||15;return t>o},obterMetricasUsuario(){return{itensPorHora:this.usuario.metricas?.itensPorHora||0,taxaAcerto:this.usuario.metricas?.taxaAcerto||0,diasAtivos:this.usuario.metricas?.diasAtivos||0,totalItens:this.usuario.contador||0,nivel:this.usuario.nivel||1}},obterMetricasGerais(){return Object.keys(this.metricasGerais).length>0?this.metricasGerais:{mediaItensPorHora:35,mediaTaxaAcerto:88,mediaDiasAtivos:18,totalUsuarios:150,periodo:"mensal"}},calcularProgresso(){const e=this.obterMetricasUsuario(),a=this.obterMetricasGerais(),t=[Math.min(100,e.itensPorHora/a.mediaItensPorHora*100),Math.min(100,e.taxaAcerto/a.mediaTaxaAcerto*100),Math.min(100,e.diasAtivos/a.mediaDiasAtivos*100)];return t.reduce((o,n)=>o+n,0)/t.length},calcularXP(){this.obterMetricasUsuario();let a=0;return this.calcularProgresso()>120&&(a=50),this.calcularProgresso()>150&&(a=100),100+a},obterDescricao(){const e=this.calcularProgresso();return e>150?"Desempenho excepcional - muito acima da m√©dia geral!":e>120?"Alto desempenho - significativamente acima da m√©dia":"Acima da m√©dia geral de desempenho"},obterMetricasComparativas(){const e=this.obterMetricasUsuario(),a=this.obterMetricasGerais();return{produtividade:{usuario:e.itensPorHora,media:a.mediaItensPorHora,diferenca:((e.itensPorHora-a.mediaItensPorHora)/a.mediaItensPorHora*100).toFixed(1)},precisao:{usuario:e.taxaAcerto,media:a.mediaTaxaAcerto,diferenca:((e.taxaAcerto-a.mediaTaxaAcerto)/a.mediaTaxaAcerto*100).toFixed(1)},consistencia:{usuario:e.diasAtivos,media:a.mediaDiasAtivos,diferenca:((e.diasAtivos-a.metediaDiasAtivos)/a.mediaDiasAtivos*100).toFixed(1)}}},obterPeriodo(){return this.metricasGerais.periodo||"mensal"}}};function Ta(e,a,t,o,n,i){const r=d("ConquistaBase");return c(),g(r,{"conquista-data":i.conquistaData},null,8,["conquista-data"])}const Sa=h(La,[["render",Ta],["__scopeId","data-v-5f7d3f92"]]),Ia={name:"SelosConquistas",components:{PrimeiroDia:Fe,MetaBatida:Ne,Explorador:Xe,Maratona:ze,Consistencia:ra,Relampago:Je,ZeroFaltas:Ye,Detetive:ta,GuardiaoPresenca:pa,LendaViva:va,LiderPodio:ba,MestreCorredores:Da,OInvencivel:Aa,PioneiroDia:ka,TopPerformer:Sa},props:{usuario:{type:Object,required:!0},corredoresUnicos:{type:Array,default:()=>[]},itensFaltantes:{type:Array,default:()=>[]},atividadesRecentes:{type:Array,default:()=>[]}},setup(e){const a=S(),t=M(!1),o=v(()=>(e.usuario.contador||0)+(e.usuario.xpConquistas||0)),n=v(()=>a.calcularNivel(o.value)),i=v(()=>15),r=v(()=>{let m=0;return(e.usuario.contador||0)>0&&m++,(e.usuario.contador||0)>=500&&m++,e.corredoresUnicos.length>=5&&m++,(e.usuario.contador||0)>=1e3&&m++,(e.usuario.contador||0)/500>=.75&&m++,e.atividadesRecentes.length>=50&&m++,e.itensFaltantes.length===0&&(e.usuario.contador||0)>0&&m++,e.itensFaltantes.length>=10&&m++,(e.usuario.diasAtivos||0)>=30&&m++,(e.usuario.diasAuditados||0)>=365&&m++,(e.usuario.posicaoRanking||999)<=3&&m++,(e.usuario.metricas?.velocidadeMedia||0)>=100&&m++,(e.usuario.sequenciaVitorias||0)>=30&&m++,(e.usuario.primeiroDodia||0)>=10&&m++,(e.usuario.metricas?.ranking||100)<=10&&m++,m});return{mostrarTodas:t,xpTotal:o,nivelAtual:n,totalConquistas:i,conquistasDesbloqueadas:r,toggleMostrarTodas:()=>{t.value=!t.value}}}},Ua={class:"conquistas-section"},ja={class:"conquistas-header"},Ra={class:"xp-summary"},wa={class:"xp-total"},Fa={class:"xp-nivel"},Ba={class:"mostrar-mais-container"},Oa={key:0},Na={key:1},Ha={class:"conquistas-stats"},Ea={class:"stat-card"},Xa={class:"stat-number"},Ga={class:"stat-card"},Va={class:"stat-number"},za={class:"stat-card"},Qa={class:"stat-number"};function Za(e,a,t,o,n,i){const r=d("PrimeiroDia"),f=d("MetaBatida"),m=d("Explorador"),y=d("Maratona"),A=d("Consistencia"),$=d("Relampago"),C=d("ZeroFaltas"),_=d("Detetive"),P=d("GuardiaoPresenca"),I=d("LendaViva"),U=d("LiderPodio"),j=d("MestreCorredores"),R=d("OInvencivel"),w=d("PioneiroDia"),F=d("TopPerformer");return c(),l("div",Ua,[s("div",ja,[a[1]||(a[1]=s("h2",{class:"section-title"},"üèÜ Conquistas e Selos",-1)),s("div",Ra,[s("span",wa,u(o.xpTotal)+" XP Total",1),s("span",Fa,"N√≠vel "+u(o.nivelAtual),1)])]),s("div",{class:D(["conquistas-grid",{expandido:o.mostrarTodas}])},[p(r,{usuario:t.usuario},null,8,["usuario"]),p(f,{usuario:t.usuario},null,8,["usuario"]),p(m,{usuario:t.usuario,"corredores-unicos":t.corredoresUnicos},null,8,["usuario","corredores-unicos"]),p(y,{usuario:t.usuario},null,8,["usuario"]),p(A,{usuario:t.usuario},null,8,["usuario"]),o.mostrarTodas?(c(),l(k,{key:0},[p($,{usuario:t.usuario,"atividades-recentes":t.atividadesRecentes},null,8,["usuario","atividades-recentes"]),p(C,{usuario:t.usuario,"itens-faltantes":t.itensFaltantes},null,8,["usuario","itens-faltantes"]),p(_,{usuario:t.usuario,"itens-faltantes":t.itensFaltantes},null,8,["usuario","itens-faltantes"]),p(P,{usuario:t.usuario},null,8,["usuario"]),p(I,{usuario:t.usuario},null,8,["usuario"]),p(U,{usuario:t.usuario},null,8,["usuario"]),p(j,{usuario:t.usuario},null,8,["usuario"]),p(R,{usuario:t.usuario},null,8,["usuario"]),p(w,{usuario:t.usuario},null,8,["usuario"]),p(F,{usuario:t.usuario},null,8,["usuario"])],64)):b("",!0)],2),s("div",Ba,[s("button",{onClick:a[0]||(a[0]=(...B)=>o.toggleMostrarTodas&&o.toggleMostrarTodas(...B)),class:D(["btn-mostrar-mais",{expandido:o.mostrarTodas}])},[o.mostrarTodas?(c(),l("span",Na,[...a[3]||(a[3]=[s("i",{class:"fas fa-chevron-up"},null,-1),x(" Mostrar Menos ",-1)])])):(c(),l("span",Oa,[...a[2]||(a[2]=[s("i",{class:"fas fa-chevron-down"},null,-1),x(" Mostrar Mais Conquistas ",-1)])]))],2)]),s("div",Ha,[s("div",Ea,[s("span",Xa,u(o.conquistasDesbloqueadas),1),a[4]||(a[4]=s("span",{class:"stat-label"},"Desbloqueadas",-1))]),s("div",Ga,[s("span",Va,u(o.totalConquistas),1),a[5]||(a[5]=s("span",{class:"stat-label"},"Total",-1))]),s("div",za,[s("span",Qa,u(Math.round(o.conquistasDesbloqueadas/o.totalConquistas*100))+"%",1),a[6]||(a[6]=s("span",{class:"stat-label"},"Completadas",-1))])])])}const Ja=h(Ia,[["render",Za],["__scopeId","data-v-fd2bd82c"]]),Ka={name:"TimelineAtividades",props:{atividadesRecentes:{type:Array,required:!0}},methods:{formatarTempo(e){const t=new Date-e,o=Math.floor(t/(1e3*60*60));if(o<1)return"H√° poucos minutos";if(o===1)return"H√° 1 hora";if(o<24)return`H√° ${o} horas`;const n=Math.floor(o/24);return n===1?"H√° 1 dia":`H√° ${n} dias`}}},Wa={class:"timeline-section"},Ya={class:"timeline"},et={class:"timeline-content"},at={class:"timeline-time"},tt={key:0,class:"timeline-details"};function ot(e,a,t,o,n,i){return c(),l("div",Wa,[a[1]||(a[1]=s("h2",{class:"section-title"},"‚è∞ Atividades Recentes",-1)),s("div",Ya,[(c(!0),l(k,null,T(t.atividadesRecentes,(r,f)=>(c(),l("div",{key:f,class:"timeline-item"},[a[0]||(a[0]=s("div",{class:"timeline-marker"},null,-1)),s("div",et,[s("h4",null,u(r.descricao),1),s("p",at,u(i.formatarTempo(r.timestamp)),1),r.detalhes?(c(),l("p",tt,u(r.detalhes),1)):b("",!0)])]))),128))])])}const st=h(Ka,[["render",ot],["__scopeId","data-v-517129b2"]]),rt={name:"QrCodeMatricula",components:{QrcodeVue:O},props:{usuario:{type:Object,required:!0}},computed:{valorQrCode(){return this.usuario.id.toString()}}},it={class:"qr-code-card"},nt={class:"qr-code-content"},ct={class:"matricula-info"},ut={class:"matricula-text"};function dt(e,a,t,o,n,i){const r=d("qrcode-vue");return c(),l("div",it,[a[0]||(a[0]=s("h2",{class:"section-title"},"üì± QR Code da Matr√≠cula",-1)),s("div",nt,[p(r,{value:i.valorQrCode,size:120,level:"H",class:"qr-code"},null,8,["value"]),s("div",ct,[s("span",ut,u(t.usuario.id),1)])])])}const lt=h(rt,[["render",dt],["__scopeId","data-v-70e23e8a"]]),mt={name:"ConquistasTimeline",props:{usuario:{type:Object,required:!0},corredoresUnicos:{type:Array,default:()=>[]},itensFaltantes:{type:Array,default:()=>[]}},setup(e){const a=M("all"),t=M(1),o=M(8),n=M(null),i=[{key:"all",label:"Todas",icon:"üèÜ"},{key:"desbloqueadas",label:"Desbloqueadas",icon:"‚úÖ"},{key:"recentes",label:"Recentes",icon:"üÜï"},{key:"altas",label:"Alto XP",icon:"‚≠ê"}],r=v(()=>[{id:"primeira_auditoria",nome:"Primeiro Dia",descricao:"Fez sua primeira auditoria",icone:"üéâ",xp:10,desbloqueada:(e.usuario.contador||0)>0,timestamp:new Date(Date.now()-25056e5),raridade:"Comum",dificuldade:"F√°cil"},{id:"meta_100",nome:"Centena",descricao:"Leu 100 itens",icone:"üíØ",xp:15,desbloqueada:(e.usuario.contador||0)>=100,timestamp:new Date(Date.now()-216e7),raridade:"Comum",dificuldade:"F√°cil",progresso:Math.min(100,(e.usuario.contador||0)/100*100)},{id:"meta_500",nome:"Meta Batida",descricao:"Leu mais de 500 itens",icone:"üéØ",xp:50,desbloqueada:(e.usuario.contador||0)>=500,timestamp:new Date(Date.now()-1728e6),raridade:"Incomum",dificuldade:"M√©dio",progresso:Math.min(100,(e.usuario.contador||0)/500*100)},{id:"explorador",nome:"Explorador",descricao:"Cobriu 5+ corredores",icone:"üó∫Ô∏è",xp:25,desbloqueada:e.corredoresUnicos.length>=5,timestamp:new Date(Date.now()-15552e5),raridade:"Comum",dificuldade:"F√°cil",progresso:Math.min(100,e.corredoresUnicos.length/5*100)},{id:"maratona",nome:"Maratona",descricao:"Leu mais de 1000 itens",icone:"üèÖ",xp:100,desbloqueada:(e.usuario.contador||0)>=1e3,timestamp:new Date(Date.now()-1296e6),raridade:"Raro",dificuldade:"Dif√≠cil",progresso:Math.min(100,(e.usuario.contador||0)/1e3*100)}].sort((_,P)=>_.desbloqueada&&!P.desbloqueada?-1:!_.desbloqueada&&P.desbloqueada?1:_.desbloqueada&&P.desbloqueada?new Date(P.timestamp)-new Date(_.timestamp):P.xp-_.xp)),f=v(()=>{const C=new Date;switch(a.value){case"desbloqueadas":return r.value.filter(_=>_.desbloqueada);case"recentes":return r.value.filter(_=>_.desbloqueada?C-new Date(_.timestamp)<10080*60*1e3:!1);case"altas":return r.value.filter(_=>_.xp>=50);default:return r.value}}),m=v(()=>Math.ceil(f.value.length/o.value)),y=v(()=>{const C=(t.value-1)*o.value,_=C+o.value;return f.value.slice(C,_)}),A=v(()=>r.value.filter(C=>C.desbloqueada)),$=v(()=>A.value.reduce((C,_)=>C+_.xp,0));return{selectedFilter:a,currentPage:t,itemsPerPage:o,selectedConquista:n,conquistaFilters:i,conquistasDisponiveis:r,filteredConquistas:f,totalPages:m,paginatedConquistas:y,conquistasDesbloqueadas:A,totalXpConquistas:$}},methods:{formatarDataConquista(e){if(!e)return"Data desconhecida";const a=new Date(e),o=new Date-a,n=Math.floor(o/(1e3*60*60*24));return n===0?"Hoje":n===1?"Ontem":n<7?`H√° ${n} dias`:n<30?`H√° ${Math.floor(n/7)} semanas`:a.toLocaleDateString("pt-BR")},getConquistaTipo(e){return e.desbloqueada?e.xp>=100?"legendary":e.xp>=50?"epic":"common":"locked"},isRecentConquista(e){return e.desbloqueada?new Date-new Date(e.timestamp)<10080*60*1e3:!1},getDificuldadeClass(e){switch(e.dificuldade){case"F√°cil":return"facil";case"M√©dio":return"medio";case"Dif√≠cil":return"dificil";default:return"facil"}},getDificuldadeTexto(e){return e.dificuldade||"Normal"},getRaridadeClass(e){switch(e.raridade){case"Comum":return"comum";case"Incomum":return"incomum";case"Raro":return"raro";default:return"comum"}},getRaridadePercentual(e){return{Comum:85,Incomum:65,Raro:35}[e.raridade]||50},selectConquista(e){this.selectedConquista?.id===e.id?this.selectedConquista=null:this.selectedConquista=e},getCondicoesConquista(e){return{primeira_auditoria:"Complete sua primeira auditoria de estoque",meta_100:"Leia pelo menos 100 itens durante suas auditorias",meta_500:"Alcance a meta de 500 itens lidos",explorador:"Visite e audite pelo menos 5 corredores diferentes",maratona:"Demonstre dedica√ß√£o lendo mais de 1000 itens"}[e.id]||"Condi√ß√µes n√£o definidas"}},watch:{selectedFilter(){this.currentPage=1}}},ht={class:"conquistas-timeline-section"},pt={class:"timeline-header"},ft={class:"timeline-controls"},_t={class:"conquista-filter"},vt=["onClick"],gt={class:"filter-icon"},qt={class:"conquista-stats"},bt={class:"stat-item"},Ct={class:"stat-item"},Pt={class:"timeline-container"},Dt={class:"timeline"},xt=["onClick"],$t={class:"conquista-emoji"},At={class:"conquista-main"},yt={class:"conquista-header"},Mt={class:"conquista-badges"},kt={key:0,class:"badge recent"},Lt={class:"badge xp"},Tt={class:"conquista-descricao"},St={class:"conquista-meta"},It={class:"conquista-data"},Ut={key:0,class:"conquista-expanded"},jt={class:"conquista-detalhes"},Rt={class:"detalhe-section"},wt={key:0,class:"detalhe-section"},Ft={class:"progresso-bar"},Bt={class:"progresso-text"},Ot={key:1,class:"detalhe-section"},Nt={class:"raridade-nome"},Ht={class:"raridade-percentual"},Et={key:0,class:"empty-state"},Xt={key:0,class:"pagination"},Gt=["disabled"],Vt={class:"page-info"},zt=["disabled"];function Qt(e,a,t,o,n,i){return c(),l("div",ht,[s("div",pt,[a[4]||(a[4]=s("h2",{class:"section-title"},"üèÜ Hist√≥rico de Conquistas",-1)),s("div",ft,[s("div",_t,[(c(!0),l(k,null,T(o.conquistaFilters,r=>(c(),l("button",{key:r.key,onClick:f=>o.selectedFilter=r.key,class:D([{active:o.selectedFilter===r.key},"filter-btn"])},[s("span",gt,u(r.icon),1),x(" "+u(r.label),1)],10,vt))),128))]),s("div",qt,[s("span",bt,[a[2]||(a[2]=s("i",{class:"fas fa-trophy"},null,-1)),x(" "+u(o.conquistasDesbloqueadas.length)+" desbloqueadas ",1)]),s("span",Ct,[a[3]||(a[3]=s("i",{class:"fas fa-star"},null,-1)),x(" "+u(o.totalXpConquistas)+" XP ganho ",1)])])])]),s("div",Pt,[s("div",Dt,[(c(!0),l(k,null,T(o.paginatedConquistas,(r,f)=>(c(),l("div",{key:r.id,class:"timeline-item conquista-item",style:L({animationDelay:`${f*.1}s`}),onClick:m=>i.selectConquista(r)},[s("div",{class:D(["timeline-marker conquista-marker",i.getConquistaTipo(r)])},[s("span",$t,u(r.icone),1)],2),s("div",{class:D(["timeline-content conquista-content",{expanded:o.selectedConquista?.id===r.id}])},[s("div",At,[s("div",yt,[s("h4",null,u(r.nome),1),s("div",Mt,[i.isRecentConquista(r)?(c(),l("span",kt,"üÜï Nova")):b("",!0),s("span",Lt,"+"+u(r.xp)+" XP",1)])]),s("p",Tt,u(r.descricao),1),s("div",St,[s("span",It,[a[5]||(a[5]=s("i",{class:"fas fa-calendar"},null,-1)),x(" "+u(i.formatarDataConquista(r.timestamp)),1)]),s("span",{class:D(["conquista-dificuldade",i.getDificuldadeClass(r)])},[a[6]||(a[6]=s("i",{class:"fas fa-star"},null,-1)),x(" "+u(i.getDificuldadeTexto(r)),1)],2)])]),o.selectedConquista?.id===r.id?(c(),l("div",Ut,[s("div",jt,[s("div",Rt,[a[7]||(a[7]=s("h5",null,"üéØ Como Conquistar",-1)),s("p",null,u(i.getCondicoesConquista(r)),1)]),r.progresso!==void 0?(c(),l("div",wt,[a[8]||(a[8]=s("h5",null,"üìà Seu Progresso",-1)),s("div",Ft,[s("div",{class:"progresso-fill",style:L({width:`${r.progresso}%`})},null,4)]),s("span",Bt,u(Math.round(r.progresso))+"% conclu√≠do",1)])):b("",!0),r.raridade?(c(),l("div",Ot,[a[9]||(a[9]=s("h5",null,"üíé Raridade",-1)),s("div",{class:D(["raridade-info",i.getRaridadeClass(r)])},[s("span",Nt,u(r.raridade),1),s("span",Ht,u(i.getRaridadePercentual(r))+"% dos usu√°rios",1)],2)])):b("",!0)])])):b("",!0)],2)],12,xt))),128)),o.filteredConquistas.length===0?(c(),l("div",Et,[...a[10]||(a[10]=[s("i",{class:"fas fa-trophy"},null,-1),s("h3",null,"Nenhuma conquista encontrada",-1),s("p",null,"Continue auditando para desbloquear suas primeiras conquistas!",-1)])])):b("",!0)]),o.totalPages>1?(c(),l("div",Xt,[s("button",{onClick:a[0]||(a[0]=r=>o.currentPage--),disabled:o.currentPage===1,class:"page-btn"},[...a[11]||(a[11]=[s("i",{class:"fas fa-chevron-left"},null,-1)])],8,Gt),s("span",Vt,u(o.currentPage)+" de "+u(o.totalPages),1),s("button",{onClick:a[1]||(a[1]=r=>o.currentPage++),disabled:o.currentPage===o.totalPages,class:"page-btn"},[...a[12]||(a[12]=[s("i",{class:"fas fa-chevron-right"},null,-1)])],8,zt)])):b("",!0)])])}const Zt=h(mt,[["render",Qt],["__scopeId","data-v-3b10ab03"]]),Jt={name:"PerfilUsuario",components:{PerfilHeader:ge,SelosConquistas:Ja,TimelineAtividades:st,QrCodeMatricula:lt,ConquistasTimeline:Zt},props:{id:{type:String,required:!0}},setup(){const e=H(),a=N();return{voltarParaLista:()=>{e.options.history.state.back?e.back():e.push("/usuarios")},lojaStore:a}},data(){return{usuario:{id:"",nome:"",contador:0,iniciais:"",foto:null,xpConquistas:0,totalAuditorias:0},carregando:!0,mediaGeral:85,atividadesRecentes:[],dadosUsuario:[],nivelStore:null}},async mounted(){try{this.nivelStore=S(),this.nivelStore.carregarUsuarios().catch(console.error),await this.carregarUsuarioPorId(this.id)}catch(e){console.error("Erro ao inicializar perfil:",e),this.carregando=!1}},computed:{percentualConcluido(){return Math.min(100,Math.round(this.usuario.contador/500*100))},progressStyle(){return{"--progress":`${this.percentualConcluido}%`}},diferencaMedia(){return this.usuario.contador-this.mediaGeral},corredoresUnicos(){const e=new Set;return this.dadosUsuario.forEach(a=>{a.Local&&e.add(a.Local)}),Array.from(e)},corredoresComContagem(){const e={};this.dadosUsuario.forEach(t=>{t.Local&&(e[t.Local]=(e[t.Local]||0)+1)});const a=Object.values(e).reduce((t,o)=>t+o,0);return Object.entries(e).map(([t,o])=>({nome:t,contagem:o,percentual:a>0?Math.round(o/a*100):0})).sort((t,o)=>o.contagem-t.contagem)},itensFaltantes(){return this.dadosUsuario.filter(e=>(parseInt(e["Estoque atual"])||0)<10)},posicaoRanking(){if(!this.nivelStore||!this.usuario.id)return 1;try{return this.nivelStore.calcularPosicaoRanking(this.usuario.id)}catch(e){return console.warn("Erro ao calcular posi√ß√£o ranking:",e),1}},mediaDesempenho(){if(!this.nivelStore||!this.usuario.id)return 0;try{return this.nivelStore.calcularMediaDesempenho(this.usuario.id)}catch(e){return console.warn("Erro ao calcular m√©dia desempenho:",e),Math.floor(Math.random()*100)}}},methods:{async carregarUsuarioPorId(e){try{this.carregando=!0;const a=await fetch("http://localhost:3000/usuarios",{headers:{"x-loja":this.getLojaAtual()}});if(a.ok){const t=await a.json(),o=Array.isArray(t)?t.find(n=>n.id===e||n._id===e):t.id===e||t._id===e?t:null;o?(this.usuario={...o,iniciais:this.obterIniciais(o.nome),xpConquistas:this.nivelStore?.calcularXpConquistas(o)||0},await this.carregarDadosDetalhados(o.id||o._id)):(console.error("Usu√°rio n√£o encontrado:",e),this.usuario={id:e,nome:`Usu√°rio ${e}`,contador:Math.floor(Math.random()*800)+100,iniciais:this.obterIniciais(`Usu√°rio ${e}`),xpConquistas:0,totalAuditorias:Math.floor(Math.random()*20)+1},await this.carregarDadosDetalhados(e))}else console.error("Erro ao carregar usu√°rio:",a.status)}catch(a){console.error("Erro ao carregar usu√°rio:",a)}finally{this.carregando=!1}},carregarDadosUsuario(e){this.usuario={...e},this.usuario.iniciais=this.obterIniciais(e.nome),this.carregarDadosDetalhados(e.id)},async carregarDadosDetalhados(e){try{const a=this.simularDadosAuditoria(e);this.dadosUsuario=a,this.processarTimeline(),this.verificarConquistas()}catch(a){console.error("Erro ao carregar dados detalhados:",a)}},simularDadosAuditoria(e){const a=this.usuario.contador||0,t=[];for(let o=0;o<Math.min(a,100);o++)t.push({Produto:`Produto ${o+1}`,Local:`Corredor ${Math.floor(Math.random()*10)+1}`,"Estoque atual":Math.floor(Math.random()*50),Situacao:Math.random()>.3?"Atualizado":"Pendente"});return t},processarTimeline(){this.atividadesRecentes=this.dadosUsuario.slice(-5).map(e=>{let a="",t="";return e.Situacao==="Atualizado"?(a="Item verificado",t=`${e.Produto} - Local: ${e.Local}`):(a="Item identificado",t=`${e.Produto} - Estoque: ${e["Estoque atual"]||0}`),{descricao:a,detalhes:t,timestamp:new Date}}).reverse()},obterIniciais(e){return e?e.split(" ").map(a=>a[0]).join("").toUpperCase().substring(0,2):"??"},verificarConquistas(){if(this.nivelStore){const e=this.nivelStore.verificarConquistasDisponiveis(this.usuario,{corredoresUnicos:this.corredoresUnicos,itensFaltantes:this.itensFaltantes,atividadesRecentes:this.atividadesRecentes});this.usuario.xpConquistas=e.reduce((a,t)=>a+t.xp,0)}},calcularLarguraBarra(e){const a=Math.max(this.usuario.contador,this.mediaGeral,1);return`${e/a*100}%`},formatarTempo(e){const t=new Date-e,o=Math.floor(t/(1e3*60*60));if(o<1)return"H√° poucos minutos";if(o===1)return"H√° 1 hora";if(o<24)return`H√° ${o} horas`;const n=Math.floor(o/24);return n===1?"H√° 1 dia":`H√° ${n} dias`},exportarRelatorio(){const e={Nome:this.usuario.nome,Matr√≠cula:this.usuario.id,"Itens Lidos":this.usuario.contador,"Meta (500)":`${this.percentualConcluido}% conclu√≠do`,"Corredores Cobertos":this.corredoresUnicos.length,"M√©dia Geral":this.mediaGeral,Desempenho:this.diferencaMedia>0?`+${this.diferencaMedia} acima`:`${this.diferencaMedia} abaixo`,"Itens com Baixo Estoque":this.itensFaltantes.length},a=["Item,Valor",...Object.entries(e).map(([i,r])=>`"${i}","${r}"`)].join(`
`),t=new Blob([a],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),n=URL.createObjectURL(t);o.setAttribute("href",n),o.setAttribute("download",`perfil_${this.usuario.nome}_${new Date().toISOString().split("T")[0]}.csv`),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o)},compartilharPerfil(){navigator.share?navigator.share({title:`Perfil de ${this.usuario.nome}`,text:`Confira o desempenho de ${this.usuario.nome} no sistema de auditoria! ${this.usuario.contador} itens verificados.`,url:window.location.href}).catch(console.error):alert("Seu navegador n√£o suporta a funcionalidade de compartilhamento.")},voltarParaLista(){this.$router?this.$router.push({name:"Usuarios"}):window.location.href="/usuarios"},getLojaAtual(){return this.lojaStore.codigoLojaAtual||"056"}}},Kt={class:"perfil-usuario-container"},Wt={class:"navigation-section"},Yt={key:0,class:"loading-container"},eo={key:1,class:"error-container"},ao={key:2};function to(e,a,t,o,n,i){const r=d("PerfilHeader"),f=d("SelosConquistas"),m=d("ConquistasTimeline"),y=d("QrCodeMatricula"),A=d("TimelineAtividades");return c(),l("div",Kt,[s("div",Wt,[s("button",{class:"back-btn",onClick:a[0]||(a[0]=(...$)=>i.voltarParaLista&&i.voltarParaLista(...$))},[...a[2]||(a[2]=[s("span",{class:"icon"},"‚Üê",-1),x(" Voltar para Lista ",-1)])])]),n.carregando?(c(),l("div",Yt,[...a[3]||(a[3]=[s("div",{class:"spinner"},null,-1),s("p",null,"Carregando perfil...",-1)])])):n.usuario.id?(c(),l("div",ao,[p(r,{usuario:n.usuario,corredoresUnicos:i.corredoresUnicos,percentualConcluido:i.percentualConcluido,posicaoRanking:i.posicaoRanking,mediaDesempenho:i.mediaDesempenho},null,8,["usuario","corredoresUnicos","percentualConcluido","posicaoRanking","mediaDesempenho"]),p(f,{usuario:n.usuario,corredoresUnicos:i.corredoresUnicos,itensFaltantes:i.itensFaltantes,atividadesRecentes:n.atividadesRecentes},null,8,["usuario","corredoresUnicos","itensFaltantes","atividadesRecentes"]),p(m,{usuario:n.usuario,corredoresUnicos:i.corredoresUnicos,itensFaltantes:i.itensFaltantes,atividadesRecentes:n.atividadesRecentes},null,8,["usuario","corredoresUnicos","itensFaltantes","atividadesRecentes"]),p(y,{usuario:n.usuario},null,8,["usuario"]),n.atividadesRecentes.length>0?(c(),g(A,{key:0,atividadesRecentes:n.atividadesRecentes},null,8,["atividadesRecentes"])):b("",!0)])):(c(),l("div",eo,[a[4]||(a[4]=s("div",{class:"error-icon"},[s("i",{class:"fas fa-exclamation-triangle"})],-1)),a[5]||(a[5]=s("h3",null,"Usu√°rio n√£o encontrado",-1)),a[6]||(a[6]=s("p",null,"O colaborador solicitado n√£o foi encontrado no sistema.",-1)),s("button",{onClick:a[1]||(a[1]=(...$)=>i.voltarParaLista&&i.voltarParaLista(...$)),class:"btn btn-primary"}," Voltar para lista ")]))])}const so=h(Jt,[["render",to],["__scopeId","data-v-91eac1c2"]]);export{so as default};
