<template>
  <div class="insights-container">
    <!-- Header -->
    <div class="header">
      <div class="header-left">
        <div class="icon-title">
          <div class="icon-area">
            <svg
              width="28"
              height="28"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M21 8C19.55 8 18.74 9.44 19.07 10.51L15.52 14.07C15.22 13.98 14.78 13.98 14.48 14.07L11.93 11.52C12.27 10.45 11.46 9 10 9C8.55 9 7.73 10.44 8.07 11.52L3.51 16.07C2.44 15.74 1 16.55 1 18C1 19.65 2.35 21 4 21C5.45 21 6.26 19.56 5.93 18.49L10.49 13.93C10.79 14.02 11.21 14.02 11.51 13.93L14.07 16.49C13.73 17.55 14.54 19 16 19C17.65 19 19 17.65 19 16C19 14.35 17.65 13 16 13C14.55 13 13.73 14.44 14.07 15.52L11.52 18.07C11.22 17.98 10.78 17.98 10.48 18.07L5.93 13.51C6.26 12.44 5.45 11 4 11C2.35 11 1 12.35 1 14C1 15.55 2.45 16 4 16C4.78 16 5.91 15.73 6.48 15.07L11.04 10.51C11.36 10.81 11.79 11 12.25 11C12.71 11 13.14 10.81 13.46 10.51L18.02 15.07C18.59 15.73 19.72 16 20.5 16C21.33 16 22 15.33 22 14.5C22 13.67 21.33 13 20.5 13C19.67 13 19 13.67 19 14.5C19 14.78 19.09 15.05 19.26 15.26L16.74 12.74C16.95 12.91 17.22 13 17.5 13C18.33 13 19 12.33 19 11.5C19 10.67 18.33 10 17.5 10C16.67 10 16 10.67 16 11.5C16 11.78 16.09 12.05 16.26 12.26L12.74 8.74C12.95 8.91 13.22 9 13.5 9C14.33 9 15 8.33 15 7.5C15 6.67 14.33 6 13.5 6C12.67 6 12 6.67 12 7.5C12 7.78 12.09 8.05 12.26 8.26L8.74 4.74C8.95 4.91 9.22 5 9.5 5C10.33 5 11 4.33 11 3.5C11 2.67 10.33 2 9.5 2C8.67 2 8 2.67 8 3.5C8 3.78 8.09 4.05 8.26 4.26L4.74 7.78C4.95 7.61 5.22 7.5 5.5 7.5C6.33 7.5 7 6.83 7 6C7 5.17 6.33 4.5 5.5 4.5C4.67 4.5 4 5.17 4 6C4 6.28 4.09 6.55 4.26 6.76L1.74 9.28C1.55 9.09 1.28 9 1 9C0.45 9 0 9.45 0 10C0 10.55 0.45 11 1 11C1.28 11 1.55 10.91 1.74 10.72L4.26 13.24C4.09 13.45 4 13.72 4 14C4 14.55 4.45 15 5 15C5.55 15 6 14.55 6 14C6 13.72 5.91 13.45 5.72 13.28L9.24 9.76C9.45 9.91 9.72 10 10 10C10.55 10 11 9.55 11 9C11 8.45 10.55 8 10 8C9.72 8 9.45 8.09 9.24 8.28L12.76 11.8C12.59 12.01 12.5 12.28 12.5 12.5C12.5 13.05 12.95 13.5 13.5 13.5C14.05 13.5 14.5 13.05 14.5 12.5C14.5 11.95 14.05 11.5 13.5 11.5C13.28 11.5 13.01 11.59 12.8 11.76L16.32 15.28C16.13 15.09 15.86 15 15.5 15C14.95 15 14.5 15.45 14.5 16C14.5 16.55 14.95 17 15.5 17C16.05 17 16.5 16.55 16.5 16C16.5 15.72 16.41 15.45 16.22 15.28L19.74 11.76C19.55 11.91 19.28 12 19 12C18.45 12 18 11.55 18 11C18 10.45 18.45 10 19 10C19.28 10 19.55 10.09 19.74 10.28L21.72 12.26C21.91 12.45 22 12.72 22 13C22 13.55 22.45 14 23 14C23.55 14 24 13.55 24 13C24 12.45 23.55 12 23 12C22.72 12 22.45 12.09 22.26 12.28L20.28 14.26C20.09 14.45 20 14.72 20 15C20 15.55 20.45 16 21 16C21.55 16 22 15.55 22 15C22 14.45 21.55 14 21 14C20.72 14 20.45 14.09 20.26 14.28L18.28 16.26C18.09 16.45 18 16.72 18 17C18 17.55 18.45 18 19 18C19.55 18 20 17.55 20 17C20 16.72 19.91 16.45 19.72 16.28L21.72 14.28C21.91 14.45 22 14.72 22 15C22 15.55 22.45 16 23 16C23.55 16 24 15.55 24 15C24 14.45 23.55 14 23 14Z"
                fill="currentColor"
              />
            </svg>
          </div>
          <div class="text-content">
            <div class="titulo">Insights da Loja</div>
            <div class="descricao">
              Análises inteligentes e recomendações para melhorar o desempenho
            </div>
          </div>
        </div>
      </div>
      <div class="header-controls">
        <div class="insights-actions">
          <button
            class="action-btn"
            :class="{ active: tipoInsightAtual === 'etiqueta' }"
            @click="alterarTipoInsight('etiqueta')"
          >
            Etiqueta
          </button>
          <button
            class="action-btn"
            :class="{ active: tipoInsightAtual === 'presenca' }"
            @click="alterarTipoInsight('presenca')"
          >
            Presença
          </button>
          <button
            class="action-btn"
            :class="{ active: tipoInsightAtual === 'ruptura' }"
            @click="alterarTipoInsight('ruptura')"
          >
            Ruptura
          </button>
        </div>
      </div>
    </div>

    <!-- Stats Overview -->
    <div class="stats-overview">
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon primary">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20ZM10.5 17.5L8 15L9.41 13.59L10.5 14.67L13.59 11.59L15 13L10.5 17.5Z"
                fill="currentColor"
              />
            </svg>
          </div>
          <div class="stat-content">
            <span class="stat-value">{{ itensAuditados }}</span>
            <span class="stat-label">Itens Auditados</span>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon warning">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M1 21H23L12 2L1 21ZM13 18H11V16H13V18ZM13 14H11V10H13V14Z"
                fill="currentColor"
              />
            </svg>
          </div>
          <div class="stat-content">
            <span class="stat-value">{{ valorRuptura }}</span>
            <span class="stat-label">Ruptura</span>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon success">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM10 17L5 12L6.41 10.59L10 14.17L17.59 6.58L19 8L10 17Z"
                fill="currentColor"
              />
            </svg>
          </div>
          <div class="stat-content">
            <span class="stat-value">{{ aderencia }}</span>
            <span class="stat-label">Aderência</span>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon info">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V20H20V18C20 15.34 14.67 14 12 14Z"
                fill="currentColor"
              />
            </svg>
          </div>
          <div class="stat-content">
            <span class="stat-value">{{ itensPorColaborador }}</span>
            <span class="stat-label">Itens / Colaborador</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Grid de Insights -->
    <div class="insights-grid">
      <!-- Performance -->
      <div class="insight-card performance">
        <div class="card-header">
          <div class="card-icon">
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M16 6L18.29 8.29L13.41 13.17L9.41 9.17L2 16.59L3.41 18L9.41 12L13.41 16L19.71 9.71L22 12V6H16Z"
                fill="currentColor"
              />
            </svg>
          </div>
          <div class="card-title">
            <h3>Performance</h3>
            <p class="card-subtitle">Desempenho por setor</p>
          </div>
        </div>
        <div class="card-content">
          <div class="metric-list">
            <div class="metric-item">
              <div class="metric-info">
                <span class="metric-label">Setor Destaque</span>
                <span class="metric-value">{{ setorDestaque.nome }}</span>
              </div>
              <div class="metric-badge positive">
                <svg
                  width="12"
                  height="12"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path d="M7 14L12 9L17 14H7Z" fill="currentColor" />
                </svg>
                {{ setorDestaque.valor }}
              </div>
            </div>
            <div class="metric-item">
              <div class="metric-info">
                <span class="metric-label">Setor Crítico</span>
                <span class="metric-value">{{ setorCritico.nome }}</span>
              </div>
              <div class="metric-badge negative">
                <svg
                  width="12"
                  height="12"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path d="M7 10L12 15L17 10H7Z" fill="currentColor" />
                </svg>
                {{ setorCritico.valor }}
              </div>
            </div>
          </div>
           <div class="progress-section">
            <div class="progress-header">
              <span class="progress-label">Aderência Geral</span>
              <span class="progress-value">{{ aderencia }}</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" :style="{ width: aderencia }"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Alertas -->
      <div class="insight-card alertas">
        <div class="card-header">
          <div class="card-icon">
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M1 21H23L12 2L1 21ZM13 18H11V16H13V18ZM13 14H11V10H13V14Z"
                fill="currentColor"
              />
            </svg>
          </div>
          <div class="card-title">
            <h3>Alertas Críticos</h3>
            <p class="card-subtitle">Atenção necessária</p>
          </div>
        </div>
        <div class="card-content">
          <div class="alert-list">
            <div class="alert-item critical" v-if="setorCritico.nome !== 'N/A'">
              <div class="alert-indicator"></div>
              <div class="alert-content">
                <span class="alert-title">Baixo Desempenho</span>
                <span class="alert-description">O {{ setorCritico.nome }} está com {{ setorCritico.valor }} de aderência.</span>
              </div>
            </div>
            <div class="alert-item medium" v-if="valorRuptura !== 'R$ 0,00'">
              <div class="alert-indicator"></div>
              <div class="alert-content">
                <span class="alert-title">Valor de Ruptura</span>
                <span class="alert-description">Total de {{ valorRuptura }} em produtos de ruptura.</span>
              </div>
            </div>
             <div v-if="setorCritico.nome === 'N/A' && valorRuptura === 'R$ 0,00'" class="alert-item low">
                <div class="alert-indicator"></div>
                <div class="alert-content">
                  <span class="alert-title">Tudo Certo!</span>
                  <span class="alert-description">Nenhum alerta crítico para hoje.</span>
                </div>
              </div>
          </div>
        </div>
      </div>

      <!-- Tendências -->
      <div class="insight-card tendencias">
        <div class="card-header">
          <div class="card-icon">
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M16 6L18.29 8.29L13.41 13.17L9.41 9.17L2 16.59L3.41 18L9.41 12L13.41 16L19.71 9.71L22 12V6H16Z"
                fill="currentColor"
              />
            </svg>
          </div>
          <div class="card-title">
            <h3>Tendências</h3>
            <p class="card-subtitle">Direção do negócio</p>
          </div>
        </div>
        <div class="card-content">
          <div class="trend-list">
            <div class="trend-item">
               <div class="trend-indicator" :class="variacaoAuditorias >= 0 ? 'positive' : 'negative'">
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path :d="variacaoAuditorias >= 0 ? 'M7 14L12 9L17 14H7Z' : 'M7 10L12 15L17 10H7Z'" fill="currentColor" />
                </svg>
              </div>
              <div class="trend-content">
                <span class="trend-title">Variação de Auditorias</span>
                <span class="trend-value">{{ variacaoAuditorias }}% em relação ao período anterior</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Recomendações (ainda estático) -->
      <div class="insight-card recomendacoes">
        <div class="card-header">
          <div class="card-icon">
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM13 17H11V15H13V17ZM13 13H11V7H13V13Z"
                fill="currentColor"
              />
            </svg>
          </div>
          <div class="card-title">
            <h3>Recomendações</h3>
            <p class="card-subtitle">Ações sugeridas</p>
          </div>
        </div>
        <div class="card-content">
          <div class="recommendation-list">
            <div class="recommendation-item">
              <div class="recommendation-content">
                <span class="recommendation-text"
                  >Reforçar o time no setor {{ setorCritico.nome }}</span
                >
                <span class="recommendation-priority">Alta prioridade</span>
              </div>
              <button class="action-btn primary">
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M9 16.17L4.83 12L3.41 13.41L9 19L21 7L19.59 5.59L9 16.17Z"
                    fill="currentColor"
                  />
                </svg>
                Aplicar
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Reconhecimentos -->
      <div class="insight-card reconhecimentos">
        <div class="card-header">
          <div class="card-icon">
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"
                fill="currentColor"
              />
            </svg>
          </div>
          <div class="card-title">
            <h3>Reconhecimentos</h3>
            <p class="card-subtitle">Destaques da equipe</p>
          </div>
        </div>
        <div class="card-content">
          <div class="recognition-list">
            <div class="recognition-item" v-if="colaboradorDestaque.nome !== 'N/A'">
              <div class="employee-avatar">
                <!-- Avatar pode ser implementado no futuro -->
                <img
                  :src="`https://ui-avatars.com/api/?name=${colaboradorDestaque.nome}&background=random`"
                  :alt="colaboradorDestaque.nome"
                />
              </div>
              <div class="employee-info">
                <span class="employee-name">{{ colaboradorDestaque.nome }}</span>
                <span class="employee-role">Colaborador Destaque</span>
                <span class="achievement">{{ colaboradorDestaque.conquista }}</span>
              </div>
              <div class="achievement-badge">
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"
                    fill="currentColor"
                  />
                </svg>
              </div>
            </div>
             <div v-else class="recognition-item">
                <div class="employee-info">
                    <span class="employee-name">Sem destaques hoje.</span>
                </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Auditorias (ainda estático) -->
      <div class="insight-card auditorias">
        <div class="card-header">
          <div class="card-icon">
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M19 3H5C3.89 3 3 3.9 3 5V19C3 20.1 3.89 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM7 12H9V17H7V12ZM11 7H13V17H11V7ZM15 10H17V17H15V10Z"
                fill="currentColor"
              />
            </svg>
          </div>
          <div class="card-title">
            <h3>Última Auditoria</h3>
            <p class="card-subtitle">Resultados recentes</p>
          </div>
        </div>
        <div class="card-content">
          <div class="audit-stats">
            <div class="stat-item">
              <span class="stat-value">94%</span>
              <span class="stat-label">Pontuação</span>
            </div>
            <div class="stat-item">
              <span class="stat-value">12</span>
              <span class="stat-label">Itens OK</span>
            </div>
            <div class="stat-item">
              <span class="stat-value">2</span>
              <span class="stat-label">Ajustes</span>
            </div>
          </div>
          <div class="improvement-section">
            <div class="improvement-indicator positive">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path d="M7 14L12 9L17 14H7Z" fill="currentColor" />
              </svg>
            </div>
            <div class="improvement-content">
              <span class="improvement-title">Melhoria Significativa</span>
              <span class="improvement-description"
                >Organização de estoque melhorou 30%</span
              >
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Loading State -->
    <div v-if="carregando" class="loading-state">
      <div class="loading-spinner"></div>
      <span>Analisando dados...</span>
    </div>
  </div>
</template>

<script setup>
import { ref, onMounted, computed, watch } from "vue";
import { useInsightsStore } from "@/stores/insightsStore";
import { useRoute } from "vue-router";

const tipoInsightAtual = ref("etiqueta"); // Mantido para controle de UI, pode ser usado no futuro
const insightsStore = useInsightsStore();
const route = useRoute();

// O código da loja é pego da rota
const lojaCodigo = computed(() => route.params.codigo);

// Conecta as propriedades do template aos getters e ao state da store
const carregando = computed(() => insightsStore.loading);
const error = computed(() => insightsStore.error);
const loja = computed(() => insightsStore.loja);

// Cards de resumo
const itensAuditados = computed(() => insightsStore.itensAuditados);
const valorRuptura = computed(() => insightsStore.valorRuptura);
const aderencia = computed(() => insightsStore.aderencia);
const itensPorColaborador = computed(() => insightsStore.itensPorColaborador);

// Cards de insights
const setorDestaque = computed(() => insightsStore.setorDestaque);
const setorCritico = computed(() => insightsStore.setorCritico);
const colaboradorDestaque = computed(() => insightsStore.colaboradorDestaque);
const variacaoAuditorias = computed(() => insightsStore.metricasAgregadas?.variacaoAuditorias || 0);

// TODO: Adicionar mais getters para os outros cards (Tendências, Recomendações)

const alterarTipoInsight = (tipo) => {
  tipoInsightAtual.value = tipo;
  // No futuro, isso pode filtrar os dados exibidos, mas por agora os dados são carregados de uma vez
};

// Carrega os dados quando o componente é montado ou quando o código da loja na rota muda
onMounted(() => {
  console.log('[InsightsLoja] Componente montado. Código da loja:', lojaCodigo.value);
  if (lojaCodigo.value) {
    insightsStore.fetchInsights(lojaCodigo.value);
  }
});

watch(lojaCodigo, (newCodigo) => {
  if (newCodigo) {
    insightsStore.fetchInsights(newCodigo);
  }
});
</script>

<style scoped>
.insights-container {
  background: #fff;
  border-radius: 20px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  padding: 2rem;
  margin: 1.5rem auto;
  width: 100%;
  position: relative;
  overflow: hidden;
  font-family: "Inter", -apple-system, BlinkMacSystemFont, sans-serif;
}

/* Header */
.header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 2rem;
  gap: 2rem;
}

.header-left {
  flex: 1;
}

.icon-title {
  display: flex;
  align-items: flex-start;
  gap: 1rem;
}

.icon-area {
  width: 60px;
  height: 60px;
  border-radius: 16px;
  background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
}

.text-content {
  display: flex;
  flex-direction: column;
}

.titulo {
  font-size: 1.8rem;
  font-weight: 700;
  background: linear-gradient(135deg, #1f2937 0%, #4b5563 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  margin: 0 0 0.5rem 0;
  line-height: 1.2;
}

.descricao {
  font-size: 1rem;
  color: #6b7280;
  margin: 0;
  line-height: 1.5;
}

.header-controls {
  display: flex;
  gap: 1.5rem;
  align-items: flex-end;
}
.header-controls .insights-actions {
  display: flex;
  gap: 0.5rem;
  background-color: #f3f4f6;
  border-radius: 12px;
  padding: 0.3rem;
}

.filter-group {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.filter-group label {
  font-size: 0.875rem;
  font-weight: 500;
  color: #374151;
}

.filtro-select {
  padding: 0.75rem 1rem;
  border: 1.5px solid #e5e7eb;
  border-radius: 12px;
  background: white;
  color: #1f2937;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  min-width: 160px;
  font-size: 0.875rem;
}

.filtro-select:focus {
  outline: none;
  border-color: #6366f1;
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}

.refresh-btn {
  padding: 0.75rem 1.5rem;
  background: #f3f4f6;
  border: 1.5px solid #e5e7eb;
  border-radius: 12px;
  color: #374151;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.875rem;
}

.header-controls .action-btn {
  padding: 0.6rem 1.2rem;
  border: none;
  border-radius: 10px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  background-color: transparent;
  color: #4b5563;
  font-size: 0.875rem;
}

.header-controls .action-btn:hover {
  background-color: #e5e7eb;
}

.header-controls .action-btn.active {
  background-color: #fff;
  color: #6366f1;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}

.refresh-btn:hover {
  background: #e5e7eb;
  border-color: #d1d5db;
}

/* Stats Overview */
.stats-overview {
  margin-bottom: 2.5rem;
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1.5rem;
}

.stat-card {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1.5rem;
  background: #f9fafb;
  border-radius: 16px;
  border: 1px solid #f3f4f6;
  transition: all 0.2s ease;
}

.stat-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}

.stat-icon {
  width: 48px;
  height: 48px;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.stat-icon.primary {
  background: rgba(99, 102, 241, 0.1);
  color: #6366f1;
}

.stat-icon.warning {
  background: rgba(245, 158, 11, 0.1);
  color: #f59e0b;
}

.stat-icon.success {
  background: rgba(16, 185, 129, 0.1);
  color: #10b981;
}

.stat-icon.info {
  background: rgba(59, 130, 246, 0.1);
  color: #3b82f6;
}

.stat-content {
  display: flex;
  flex-direction: column;
}

.stat-value {
  font-size: 1.5rem;
  font-weight: 700;
  color: #1f2937;
  margin-bottom: 0.25rem;
}

.stat-label {
  font-size: 0.875rem;
  color: #6b7280;
}

/* Insights Grid */
.insights-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
  gap: 1.5rem;
}

.insight-card {
  background: white;
  border-radius: 16px;
  padding: 1.5rem;
  border: 1px solid #f3f4f6;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.insight-card::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, #6366f1, #8b5cf6);
  transition: all 0.3s ease;
}

.insight-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
  border-color: #e5e7eb;
}

.insight-card:hover::before {
  height: 6px;
}

/* Card Header */
.card-header {
  display: flex;
  align-items: flex-start;
  gap: 1rem;
  margin-bottom: 1.5rem;
}

.card-icon {
  width: 48px;
  height: 48px;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  flex-shrink: 0;
}

.performance .card-icon {
  background: linear-gradient(135deg, #10b981, #34d399);
}

.alertas .card-icon {
  background: linear-gradient(135deg, #ef4444, #f87171);
}

.tendencias .card-icon {
  background: linear-gradient(135deg, #3b82f6, #60a5fa);
}

.recomendacoes .card-icon {
  background: linear-gradient(135deg, #8b5cf6, #a78bfa);
}

.reconhecimentos .card-icon {
  background: linear-gradient(135deg, #f59e0b, #fbbf24);
}

.auditorias .card-icon {
  background: linear-gradient(135deg, #6366f1, #818cf8);
}

.card-title h3 {
  margin: 0 0 0.25rem 0;
  color: #1f2937;
  font-size: 1.25rem;
  font-weight: 600;
}

.card-subtitle {
  margin: 0;
  font-size: 0.875rem;
  color: #6b7280;
}

/* Performance Card */
.metric-list {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  margin-bottom: 1.5rem;
}

.metric-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.75rem;
  background: #f9fafb;
  border-radius: 12px;
  border: 1px solid #f3f4f6;
}

.metric-info {
  display: flex;
  flex-direction: column;
}

.metric-label {
  font-size: 0.875rem;
  color: #6b7280;
  margin-bottom: 0.25rem;
}

.metric-value {
  font-size: 1rem;
  font-weight: 600;
  color: #1f2937;
}

.metric-badge {
  padding: 0.4rem 0.75rem;
  border-radius: 20px;
  font-size: 0.75rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 0.25rem;
}

.metric-badge.positive {
  background: rgba(16, 185, 129, 0.1);
  color: #065f46;
}

.progress-section {
  padding: 1rem;
  background: #f9fafb;
  border-radius: 12px;
  border: 1px solid #f3f4f6;
}

.progress-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.75rem;
}

.progress-label {
  font-size: 0.875rem;
  color: #374151;
  font-weight: 500;
}

.progress-value {
  font-size: 1rem;
  font-weight: 600;
  color: #1f2937;
}

.progress-bar {
  width: 100%;
  height: 8px;
  background: #e5e7eb;
  border-radius: 4px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #10b981, #34d399);
  border-radius: 4px;
  transition: width 0.5s ease;
}

/* Alertas Card */
.alert-list {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.alert-item {
  display: flex;
  align-items: flex-start;
  gap: 0.75rem;
  padding: 1rem;
  border-radius: 12px;
  border: 1px solid;
  transition: all 0.2s ease;
}

.alert-item:hover {
  transform: translateX(4px);
}

.alert-item.critical {
  background: rgba(239, 68, 68, 0.05);
  border-color: rgba(239, 68, 68, 0.2);
}

.alert-item.medium {
  background: rgba(245, 158, 11, 0.05);
  border-color: rgba(245, 158, 11, 0.2);
}

.alert-item.low {
  background: rgba(59, 130, 246, 0.05);
  border-color: rgba(59, 130, 246, 0.2);
}

.alert-indicator {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  margin-top: 0.5rem;
  flex-shrink: 0;
}

.alert-item.critical .alert-indicator {
  background: #ef4444;
}

.alert-item.medium .alert-indicator {
  background: #f59e0b;
}

.alert-item.low .alert-indicator {
  background: #3b82f6;
}

.alert-content {
  flex: 1;
}

.alert-title {
  display: block;
  font-weight: 600;
  color: #1f2937;
  margin-bottom: 0.25rem;
}

.alert-description {
  font-size: 0.875rem;
  color: #6b7280;
}

/* Tendências Card */
.trend-list {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.trend-item {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  background: #f9fafb;
  border-radius: 12px;
  border: 1px solid #f3f4f6;
  transition: all 0.2s ease;
}

.trend-item:hover {
  background: #f3f4f6;
}

.trend-indicator {
  width: 32px;
  height: 32px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.trend-indicator.positive {
  background: rgba(16, 185, 129, 0.1);
  color: #065f46;
}

.trend-indicator.negative {
  background: rgba(239, 68, 68, 0.1);
  color: #7f1d1d;
}

.trend-content {
  flex: 1;
}

.trend-title {
  display: block;
  font-weight: 600;
  color: #1f2937;
  margin-bottom: 0.25rem;
}

.trend-value {
  font-size: 0.875rem;
  color: #6b7280;
}

/* Recomendações Card */
.recommendation-list {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.recommendation-item {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 1rem;
  padding: 1rem;
  background: #f9fafb;
  border-radius: 12px;
  border: 1px solid #f3f4f6;
}

.recommendation-content {
  flex: 1;
}

.recommendation-text {
  display: block;
  font-weight: 500;
  color: #1f2937;
  margin-bottom: 0.5rem;
  line-height: 1.4;
}

.recommendation-priority {
  font-size: 0.75rem;
  padding: 0.25rem 0.75rem;
  border-radius: 12px;
  font-weight: 600;
  display: inline-block;
}

.recommendation-item:nth-child(1) .recommendation-priority {
  background: rgba(239, 68, 68, 0.1);
  color: #7f1d1d;
}

.recommendation-item:nth-child(2) .recommendation-priority {
  background: rgba(245, 158, 11, 0.1);
  color: #92400e;
}

.action-btn {
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 8px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.875rem;
  white-space: nowrap;
}

.action-btn.primary {
  background: #6366f1;
  color: white;
}

.action-btn.primary:hover {
  background: #4f46e5;
}

.action-btn.secondary {
  background: #f3f4f6;
  color: #374151;
  border: 1px solid #e5e7eb;
}

.action-btn.secondary:hover {
  background: #e5e7eb;
}

/* Reconhecimentos Card */
.recognition-list {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.recognition-item {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  background: #f9fafb;
  border-radius: 12px;
  border: 1px solid #f3f4f6;
  transition: all 0.2s ease;
}

.recognition-item:hover {
  background: #f3f4f6;
}

.employee-avatar {
  width: 48px;
  height: 48px;
  border-radius: 12px;
  overflow: hidden;
  border: 2px solid #f3f4f6;
  flex-shrink: 0;
}

.employee-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.employee-info {
  flex: 1;
}

.employee-name {
  display: block;
  font-weight: 600;
  color: #1f2937;
  margin-bottom: 0.25rem;
}

.employee-role {
  font-size: 0.75rem;
  color: #6b7280;
  margin-bottom: 0.25rem;
  display: block;
}

.achievement {
  font-size: 0.875rem;
  color: #374151;
  font-weight: 500;
}

.achievement-badge {
  width: 32px;
  height: 32px;
  border-radius: 8px;
  background: rgba(245, 158, 11, 0.1);
  color: #92400e;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

/* Auditorias Card */
.audit-stats {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
}

.stat-item {
  text-align: center;
  padding: 1rem;
  background: #f9fafb;
  border-radius: 12px;
  border: 1px solid #f3f4f6;
}

.stat-value {
  display: block;
  font-size: 1.5rem;
  font-weight: 700;
  color: #6366f1;
  margin-bottom: 0.25rem;
}

.stat-label {
  font-size: 0.875rem;
  color: #6b7280;
}

.improvement-section {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  background: rgba(16, 185, 129, 0.05);
  border-radius: 12px;
  border: 1px solid rgba(16, 185, 129, 0.2);
}

.improvement-indicator {
  width: 32px;
  height: 32px;
  border-radius: 8px;
  background: rgba(16, 185, 129, 0.1);
  color: #065f46;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.improvement-content {
  flex: 1;
}

.improvement-title {
  display: block;
  font-weight: 600;
  color: #065f46;
  margin-bottom: 0.25rem;
}

.improvement-description {
  font-size: 0.875rem;
  color: #065f46;
}

/* Loading State */
.loading-state {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.9);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 1rem;
  border-radius: 20px;
  z-index: 10;
  backdrop-filter: blur(4px);
}

.loading-spinner {
  width: 40px;
  height: 40px;
  border: 4px solid #f3f4f6;
  border-top: 4px solid #6366f1;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

/* Responsividade */
@media (max-width: 1200px) {
  .insights-grid {
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  }
}

@media (max-width: 768px) {
  .insights-container {
    padding: 1.5rem;
    margin: 1rem;
    border-radius: 16px;
  }

  .header {
    flex-direction: column;
    gap: 1.5rem;
  }

  .header-controls {
    width: 100%;
    flex-direction: column;
    gap: 1rem;
  }

  .filter-group {
    width: 100%;
  }

  .filtro-select {
    width: 100%;
  }

  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }

  .insights-grid {
    grid-template-columns: 1fr;
  }

  .audit-stats {
    grid-template-columns: 1fr;
  }

  .recommendation-item {
    flex-direction: column;
    align-items: flex-start;
    gap: 1rem;
  }

  .action-btn {
    align-self: flex-end;
  }
}

@media (max-width: 480px) {
  .stats-grid {
    grid-template-columns: 1fr;
  }

  .icon-title {
    flex-direction: column;
    text-align: center;
    gap: 1rem;
  }

  .icon-area {
    align-self: center;
  }

  .text-content {
    text-align: center;
  }

  .card-header {
    flex-direction: column;
    text-align: center;
    gap: 1rem;
  }

  .metric-item {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.5rem;
  }

  .metric-badge {
    align-self: flex-start;
  }
}
</style>
